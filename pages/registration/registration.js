"use strict";(self.webpackChunke_commerce=self.webpackChunke_commerce||[]).push([[110],{1584:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var r=a(8948),s=a(7294),l=a(4309),n=a(2823),o=a(6642),u=a(8958),i=a(8953),c=a(4250);const d=({addresses:e,name:t,onChange:a,setAddresses:r,setAddressesAnother:l,isAddress:n})=>s.createElement("ul",{className:"auth__list-address"},e.map(((o,u)=>s.createElement("li",{className:"auth__item-address",key:u},s.createElement(c.Z,{className:"auth__input-address",classNameLabel:"auth__label-address",type:"radio",name:t,onChange:a,value:String(u)},s.createElement("span",{className:"auth__span"}),s.createElement("ul",{className:"auth__list-address-value"},s.createElement("li",null,"Страна: ",o.country),s.createElement("li",null,"Город: ",o.city),s.createElement("li",null,"Индекс: ",o.postalCode),s.createElement("li",null,"Улица: ",o.streetName))),s.createElement("div",{className:"auth__item-container"},!n&&1!==e.length&&s.createElement("button",{className:"auth__button-delete",type:"button",onClick:()=>(t=>{const a=e.filter(((e,a)=>a!==t));r&&r(a)})(u)}),!n&&s.createElement("button",{className:"auth__button-copy",type:"button",onClick:()=>(t=>{l&&l((a=>[...a,e[t]]))})(u)}))))));var m=a(5435),p=a(8508),E=a(4094),h=a(1970),g=a(8712);const y=()=>{const e=new Date;return e.setFullYear(e.getFullYear()-13),e.setDate(e.getDate()-1),`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`},_=()=>{const{signIn:e}=(0,E.Z)(),t=(0,l.s0)(),[a,c]=(0,s.useState)(!1),[_,N]=(0,s.useState)(!1),[C,b]=(0,s.useState)(!1),[V,S]=(0,s.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[f,X]=(0,s.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[w,v]=(0,s.useState)([]),[A,$]=(0,s.useState)([]),k=()=>{c(!0)},F=()=>{c(!1),N(!1),b(!1)},x=()=>{N(!0)},M=()=>{b(!0)};return s.createElement(r.J9,{initialValues:{firstName:"",lastName:"",date:`${y()}`,email:"",password:"",passwordRepeat:"",shipping:"",billing:""},validationSchema:p.Tu,onSubmit:async a=>{const r=Array.from(new Set([...w,...A].map((e=>JSON.stringify(e))))).map((e=>JSON.parse(e)));let s,l,u,i;""!==a.shipping?(s=JSON.stringify(w[Number(a.shipping)]),u=r.findIndex((e=>JSON.stringify(e)===s))):u=a.shipping,""!==a.billing?(l=JSON.stringify(A[Number(a.billing)]),i=r.findIndex((e=>JSON.stringify(e)===l))):i=a.billing;const c=w.map((e=>{const t=JSON.stringify(e);return r.findIndex((e=>JSON.stringify(e)===t))})),d=A.map((e=>{const t=JSON.stringify(e);return r.findIndex((e=>JSON.stringify(e)===t))})),{email:m,firstName:p,lastName:E,password:y,date:_}=a;try{await(0,h.z)(m,p,E,y,_,r,u,i,c,d);const s=await(0,o.k0)(a.email,a.password);null!==s&&"object"==typeof s&&(n.ZP.info({content:"Регистрация прошла успешно!"}),e((()=>t("/"))),(0,o.F_)(s))}catch(e){const t=e;if(t.response&&t.response.data){const{statusCode:e,message:a}=t.response.data;(0,g.Z)(e,a)}}}},(({values:e,errors:t,touched:r,handleChange:l,dirty:n})=>s.createElement(i.Z,{name:"form-register",text:"Уже зарегистрированы?",textLink:"Войти",textButton:"Зарегистрироваться",path:"/login",title:"Регистрация",isRegister:!0,disabled:!n||!!(t.firstName||t.lastName||t.date||t.email||t.password||t.passwordRepeat),isAddAddress:a,handlePrevRegister:F},s.createElement("ul",{className:"auth__list auth__list_type_main "+(a?"auth__list_inactive":"auth__list_active")},s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Имя*",name:"firstName",htmlFor:"firstName",isInputPassword:!1,value:e.firstName,errors:t.firstName,touched:r.firstName,onChange:l})),s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Фамилия*",name:"lastName",htmlFor:"lastName",isInputPassword:!1,value:e.lastName,errors:t.lastName,touched:r.lastName,onChange:l})),s.createElement("li",null,s.createElement(u.Z,{type:"date",placeholder:"Дата рождения*",name:"date",htmlFor:"date",isInputPassword:!1,onChange:l,value:e.date,errors:t.date,touched:r.date})),s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Email*",name:"email",htmlFor:"email",isInputPassword:!1,onChange:l,value:e.email,errors:t.email,touched:r.email})),s.createElement("li",null,s.createElement(u.Z,{type:"password",placeholder:"Пароль*",name:"password",htmlFor:"password",isInputPassword:!0,onChange:l,value:e.password,errors:t.password,touched:r.password})),s.createElement("li",null,s.createElement(u.Z,{type:"password",placeholder:"Повторите пароль*",name:"passwordRepeat",htmlFor:"passwordRepeat",isInputPassword:!0,onChange:l,value:e.passwordRepeat,errors:t.passwordRepeat,touched:r.passwordRepeat}))),!a&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",onClick:k},"Добавить адреса")),s.createElement("ul",{className:"auth__list "+(a?"auth__list_active":"auth__list_inactive")},s.createElement("li",null,s.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для доставок"),!_&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button-add",type:"button",onClick:x}),s.createElement(d,{name:"shipping",onChange:l,addresses:w,setAddresses:v,setAddressesAnother:$,isAddress:C}),s.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для доставки по умолчанию кликните на карточку с адресом"))),_&&s.createElement(s.Fragment,null,s.createElement(m.Z,{onChange:l,name:"shipping",addressesState:V,setAddressesState:S}),s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(V.isPostalCodeError||V.isCityError||V.isStreetError),onClick:()=>(()=>{N(!1);const e=V.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";v((e=>[...e,{country:t,city:V.cityValue,postalCode:V.postalCodeValue,streetName:V.streetValue}]))})()},"Добавить")),s.createElement("li",null,s.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для выставления счетов"),!C&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button-add",type:"button",onClick:M}),s.createElement(d,{name:"billing",onChange:l,addresses:A,setAddresses:$,setAddressesAnother:v,isAddress:_}),s.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для выставления счета по умолчанию кликните на карточку с адресом"))),C&&s.createElement(s.Fragment,null,s.createElement(m.Z,{onChange:l,name:"billing",addressesState:f,setAddressesState:X}),s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(f.isPostalCodeError||f.isCityError||f.isStreetError),onClick:()=>(()=>{b(!1);const e=f.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";$((e=>[...e,{country:t,city:f.cityValue,postalCode:f.postalCodeValue,streetName:f.streetValue}]))})()},"Добавить"))))))}},5435:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(7294),s=a(8958),l=a(9849);const n=[{postalCode:/^[0-9]{2}-[0-9]{3}$/,errorMessage:"Почтовый индекс должен иметь формат XX-XXX.",engName:"Poland",ruName:"Польша (PL)",code:"PL"},{postalCode:/^[0-9]{3,3}0$/,errorMessage:"Почтовый индекс должен иметь формат XXX0.",engName:"Belgium",ruName:"Бельгия (BE)",code:"BE"},{postalCode:/^\d{5}$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX.",engName:"Germany",ruName:"Германия (DE)",code:"DE"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"Austria",ruName:"Австрия (AT)",code:"AT"},{postalCode:/^\d{5}(?:-\d{4})?$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX, либо XXXXX-XXXX.",engName:"USA",ruName:"США (US)",code:"US"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"France",ruName:"Франция (FR)",code:"FR"}],o=({name:e,addressesState:{countryValue:t,cityValue:a,streetValue:o,postalCodeValue:u},setAddressesState:i})=>{const[c,d]=(0,r.useState)(!1),[m,p]=(0,r.useState)({cityErrorValue:"",streetErrorValue:"",postalCodeErrorValue:"",emptyErrorMessage:"",defaultErrorMessage:"Поле обязательно к заполнению",cityErrorMessage:"Поле должно содержать хотя бы один символ и не содержать специальных символов (!@#$%^&*) или цифр.",streetErrorMessage:"Поле должно содержать хотя бы один символ"}),E=e=>{const t=e.target,a=t.textContent;t&&t.textContent&&("keydown"===e.type&&"Enter"===e.key||"click"===e.type)&&(i((e=>({...e,countryValue:a}))),d(!c))};return(0,r.useEffect)((()=>{(()=>{if(!u)return void p((e=>({...e,postalCodeErrorValue:m.defaultErrorMessage})));const e=n.find((({ruName:e})=>e===t));p((t=>({...t,postalCodeErrorValue:e&&e.postalCode.test(u)?"":`${e?.errorMessage}, где Х - цифра`})))})(),a?/^[^\d!@#$%^&*]*$/.test(a)?p((e=>({...e,cityErrorValue:m.emptyErrorMessage}))):/^[^\d!@#$%^&*]*$/.test(a)||p((e=>({...e,cityErrorValue:m.cityErrorMessage}))):p((e=>({...e,cityErrorValue:m.defaultErrorMessage}))),p(o?e=>({...e,streetErrorValue:m.emptyErrorMessage}):e=>({...e,streetErrorValue:m.defaultErrorMessage})),i((e=>({...e,isPostalCodeError:!!m.postalCodeErrorValue,isCityError:!!m.cityErrorValue,isStreetError:!!m.streetErrorValue})))}),[t,a,o,u,m.postalCodeErrorValue,m.cityErrorValue,m.streetErrorValue]),r.createElement("ul",{className:"auth__list auth__list_active"},r.createElement("li",null,r.createElement(l.Z,{sectionName:"auth",listName:"select",title:t,onClickAccordion:()=>{d(!c)},onKeydownAccordion:e=>{"Enter"===e.key&&d(!c)},isOpen:c},n.filter((({ruName:e})=>t!==e)).map((({ruName:e,engName:t})=>r.createElement("li",{className:"auth__select-list-item",value:t,key:t,tabIndex:c?0:-1,onClick:e=>E(e),onKeyDown:e=>E(e)},e))))),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Город*",name:`${e}City`,htmlFor:`${e}City`,onChange:e=>{const t=e.target;i((e=>({...e,cityValue:t.value})))},value:a,errors:m.cityErrorValue})),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Почтовый индекс*",name:`${e}Index`,htmlFor:`${e}Index`,onChange:e=>{const t=e.target;i((e=>({...e,postalCodeValue:t.value})))},value:u,errors:m.postalCodeErrorValue})),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Улица*",name:`${e}Street`,htmlFor:`${e}Street`,onChange:e=>{const t=e.target;i((e=>({...e,streetValue:t.value})))},value:o,errors:m.streetErrorValue})))}}}]);