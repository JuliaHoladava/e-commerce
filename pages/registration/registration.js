"use strict";(self.webpackChunke_commerce=self.webpackChunke_commerce||[]).push([[110],{1584:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var r=a(8948),s=a(7294),l=a(4309),n=a(2823),o=a(4094),i=a(6642),u=a(8958),c=a(5542),d=a(4250);const m=({addresses:e,name:t,onChange:a,setAddresses:r,setAddressesAnother:l,isAddress:n})=>s.createElement("ul",{className:"auth__list-address"},e.map(((o,i)=>s.createElement("li",{className:"auth__item-address",key:i},s.createElement(d.Z,{className:"auth__input-address",classNameLabel:"auth__label-address",type:"radio",name:t,onChange:a,value:String(i)},s.createElement("span",{className:"auth__span"}),s.createElement("ul",{className:"auth__list-address-value"},s.createElement("li",null,"Страна: ",o.country),s.createElement("li",null,"Город: ",o.city),s.createElement("li",null,"Индекс: ",o.postalCode),s.createElement("li",null,"Улица: ",o.streetName))),s.createElement("div",{className:"auth__item-container"},!n&&1!==e.length&&s.createElement("button",{className:"auth__button-delete",type:"button",onClick:()=>(t=>{const a=e.filter(((e,a)=>a!==t));r&&r(a)})(i)}),!n&&s.createElement("button",{className:"auth__button-copy",type:"button",onClick:()=>(t=>{l&&l((a=>[...a,e[t]]))})(i)}))))));var p=a(5435),E=a(8508),h=a(1970),g=a(8712);const y=()=>{const e=new Date;return e.setFullYear(e.getFullYear()-13),e.setDate(e.getDate()-1),`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`};var _=a(6782);const N=()=>{const{signIn:e}=(0,o.Z)(),t=(0,l.s0)(),a=(0,l.HJ)(),[d,N]=(0,s.useState)(!1),[C,b]=(0,s.useState)(!1),[S,V]=(0,s.useState)(!1),[f,X]=(0,s.useState)(!1),[w,v]=(0,s.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[A,F]=(0,s.useState)({countryValue:"Польша (PL)",cityValue:"",isCityError:!0,streetValue:"",isStreetError:!0,postalCodeValue:"",isPostalCodeError:!0}),[$,k]=(0,s.useState)([]),[Z,x]=(0,s.useState)([]),M=()=>{N(!0)},P=()=>{N(!1),b(!1),V(!1)},I=()=>{b(!0)},J=()=>{V(!0)};return s.createElement(s.Fragment,null,(f||"loading"===a.state)&&s.createElement(_.Z,{pageClassname:"registration",isDataFetching:f||"loading"===a.state}),s.createElement(r.J9,{initialValues:{firstName:"",lastName:"",date:`${y()}`,email:"",password:"",passwordRepeat:"",shipping:"",billing:""},validationSchema:E.Tu,onSubmit:async a=>{X(!0);const r=Array.from(new Set([...$,...Z].map((e=>JSON.stringify(e))))).map((e=>JSON.parse(e)));let s,l,o,u;""!==a.shipping?(s=JSON.stringify($[Number(a.shipping)]),o=r.findIndex((e=>JSON.stringify(e)===s))):o=a.shipping,""!==a.billing?(l=JSON.stringify(Z[Number(a.billing)]),u=r.findIndex((e=>JSON.stringify(e)===l))):u=a.billing;const c=$.map((e=>{const t=JSON.stringify(e);return r.findIndex((e=>JSON.stringify(e)===t))})),d=Z.map((e=>{const t=JSON.stringify(e);return r.findIndex((e=>JSON.stringify(e)===t))})),{email:m,firstName:p,lastName:E,password:y,date:_}=a;try{await(0,h.z)(m,p,E,y,_,r,o,u,c,d);const s=await(0,i.k0)(a.email,a.password);null!==s&&"object"==typeof s&&(n.ZP.info({content:"Регистрация прошла успешно!"}),e((()=>t("/"))),(0,i.F_)(s))}catch(e){X(!1);const t=e;if(t.response&&t.response.data){const{statusCode:e,message:a}=t.response.data;(0,g.Z)(e,a)}}}},(({values:e,errors:t,touched:a,handleChange:r,dirty:l})=>s.createElement(c.Z,{name:"form-register",text:"Уже зарегистрированы?",textLink:"Войти",textButton:"Зарегистрироваться",path:"/login",title:"Регистрация",isRegister:!0,isDataFetching:f,disabled:!l||!!(t.firstName||t.lastName||t.date||t.email||t.password||t.passwordRepeat),isAddAddress:d,handlePrevRegister:P},s.createElement("ul",{className:"auth__list auth__list_type_main "+(d?"auth__list_inactive":"auth__list_active")},s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Имя*",name:"firstName",htmlFor:"firstName",isInputPassword:!1,value:e.firstName,errors:t.firstName,touched:a.firstName,onChange:r})),s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Фамилия*",name:"lastName",htmlFor:"lastName",isInputPassword:!1,value:e.lastName,errors:t.lastName,touched:a.lastName,onChange:r})),s.createElement("li",null,s.createElement(u.Z,{type:"date",placeholder:"Дата рождения*",name:"date",htmlFor:"date",isInputPassword:!1,onChange:r,value:e.date,errors:t.date,touched:a.date})),s.createElement("li",null,s.createElement(u.Z,{type:"text",placeholder:"Email*",name:"email",htmlFor:"email",isInputPassword:!1,onChange:r,value:e.email,errors:t.email,touched:a.email})),s.createElement("li",null,s.createElement(u.Z,{type:"password",placeholder:"Пароль*",name:"password",htmlFor:"password",isInputPassword:!0,onChange:r,value:e.password,errors:t.password,touched:a.password})),s.createElement("li",null,s.createElement(u.Z,{type:"password",placeholder:"Повторите пароль*",name:"passwordRepeat",htmlFor:"passwordRepeat",isInputPassword:!0,onChange:r,value:e.passwordRepeat,errors:t.passwordRepeat,touched:a.passwordRepeat}))),!d&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",onClick:M},"Добавить адреса")),s.createElement("ul",{className:"auth__list "+(d?"auth__list_active":"auth__list_inactive")},s.createElement("li",null,s.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для доставок"),!C&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button-add",type:"button",onClick:I}),s.createElement(m,{name:"shipping",onChange:r,addresses:$,setAddresses:k,setAddressesAnother:x,isAddress:S}),$.length>0&&s.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для доставки по умолчанию кликните на карточку с адресом"))),C&&s.createElement(s.Fragment,null,s.createElement(p.Z,{onChange:r,name:"shipping",addressesState:w,setAddressesState:v}),s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(w.isPostalCodeError||w.isCityError||w.isStreetError),onClick:()=>(()=>{b(!1);const e=w.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";k((e=>[...e,{country:t,city:w.cityValue,postalCode:w.postalCodeValue,streetName:w.streetValue}]))})()},"Добавить")),s.createElement("li",null,s.createElement("h2",{className:"auth__subtitle"},"Добавьте адреса для выставления счетов"),!S&&s.createElement(s.Fragment,null,s.createElement("button",{className:"auth__button-add",type:"button",onClick:J}),s.createElement(m,{name:"billing",onChange:r,addresses:Z,setAddresses:x,setAddressesAnother:k,isAddress:C}),Z.length>0&&s.createElement("p",{className:"auth__help"},"Чтобы выбрать адрес для выставления счета по умолчанию кликните на карточку с адресом"))),S&&s.createElement(s.Fragment,null,s.createElement(p.Z,{onChange:r,name:"billing",addressesState:A,setAddressesState:F}),s.createElement("button",{className:"auth__button auth__button_type_add",type:"button",disabled:!!(A.isPostalCodeError||A.isCityError||A.isStreetError),onClick:()=>(()=>{V(!1);const e=A.countryValue.match(/\((.*?)\)/),t=e?e[1]:"";x((e=>[...e,{country:t,city:A.cityValue,postalCode:A.postalCodeValue,streetName:A.streetValue}]))})()},"Добавить")))))))}},5435:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(7294),s=a(8958),l=a(9849);const n=[{postalCode:/^[0-9]{2}-[0-9]{3}$/,errorMessage:"Почтовый индекс должен иметь формат XX-XXX.",engName:"Poland",ruName:"Польша (PL)",code:"PL"},{postalCode:/^[0-9]{3,3}0$/,errorMessage:"Почтовый индекс должен иметь формат XXX0.",engName:"Belgium",ruName:"Бельгия (BE)",code:"BE"},{postalCode:/^\d{5}$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX.",engName:"Germany",ruName:"Германия (DE)",code:"DE"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"Austria",ruName:"Австрия (AT)",code:"AT"},{postalCode:/^\d{5}(?:-\d{4})?$/,errorMessage:"Почтовый индекс должен иметь формат XXXXX, либо XXXXX-XXXX.",engName:"USA",ruName:"США (US)",code:"US"},{postalCode:/^\d{4}$/,errorMessage:"Почтовый индекс должен иметь формат XXXX.",engName:"France",ruName:"Франция (FR)",code:"FR"}],o=({name:e,addressesState:{countryValue:t,cityValue:a,streetValue:o,postalCodeValue:i},setAddressesState:u})=>{const[c,d]=(0,r.useState)(!1),[m,p]=(0,r.useState)({cityErrorValue:"",streetErrorValue:"",postalCodeErrorValue:"",emptyErrorMessage:"",defaultErrorMessage:"Поле обязательно к заполнению",cityErrorMessage:"Поле должно содержать хотя бы один символ и не содержать специальных символов (!@#$%^&*) или цифр.",streetErrorMessage:"Поле должно содержать хотя бы один символ"}),E=e=>{const t=e.target,a=t.textContent;t&&t.textContent&&("keydown"===e.type&&"Enter"===e.key||"click"===e.type)&&(u((e=>({...e,countryValue:a}))),d(!c))};return(0,r.useEffect)((()=>{(()=>{if(!i)return void p((e=>({...e,postalCodeErrorValue:m.defaultErrorMessage})));const e=n.find((({ruName:e})=>e===t));p((t=>({...t,postalCodeErrorValue:e&&e.postalCode.test(i)?"":`${e?.errorMessage}, где Х - цифра`})))})(),a?/^[^\d!@#$%^&*]*$/.test(a)?p((e=>({...e,cityErrorValue:m.emptyErrorMessage}))):/^[^\d!@#$%^&*]*$/.test(a)||p((e=>({...e,cityErrorValue:m.cityErrorMessage}))):p((e=>({...e,cityErrorValue:m.defaultErrorMessage}))),p(o?e=>({...e,streetErrorValue:m.emptyErrorMessage}):e=>({...e,streetErrorValue:m.defaultErrorMessage})),u((e=>({...e,isPostalCodeError:!!m.postalCodeErrorValue,isCityError:!!m.cityErrorValue,isStreetError:!!m.streetErrorValue})))}),[t,a,o,i,m.postalCodeErrorValue,m.cityErrorValue,m.streetErrorValue]),r.createElement("ul",{className:"auth__list auth__list_active"},r.createElement("li",null,r.createElement(l.Z,{sectionName:"auth",listName:"select",title:t,onClickAccordion:()=>{d(!c)},onKeydownAccordion:e=>{"Enter"===e.key&&d(!c)},isOpen:c},n.filter((({ruName:e})=>t!==e)).map((({ruName:e,engName:t})=>r.createElement("li",{className:"auth__select-list-item",value:t,key:t,tabIndex:c?0:-1,onClick:e=>E(e),onKeyDown:e=>E(e)},e))))),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Город*",name:`${e}City`,htmlFor:`${e}City`,onChange:e=>{const t=e.target;u((e=>({...e,cityValue:t.value})))},value:a,errors:m.cityErrorValue})),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Почтовый индекс*",name:`${e}Index`,htmlFor:`${e}Index`,onChange:e=>{const t=e.target;u((e=>({...e,postalCodeValue:t.value})))},value:i,errors:m.postalCodeErrorValue})),r.createElement("li",null,r.createElement(s.Z,{type:"text",placeholder:"Улица*",name:`${e}Street`,htmlFor:`${e}Street`,onChange:e=>{const t=e.target;u((e=>({...e,streetValue:t.value})))},value:o,errors:m.streetErrorValue})))}}}]);